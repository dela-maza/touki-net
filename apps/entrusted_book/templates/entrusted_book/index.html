<!DOCTYPE html>
<!--apps/entrusted_book/templates/entrusted_book/index.html-->
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>EntrustedBooks</title>

    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/table.css') }}">
    <link rel="stylesheet" href="{{ url_for('entrusted_book.static', filename='style.css') }}">
</head>
<body>

<h3>Entrusted Books</h3>

<div class="button-list">
    <a class="btn" href="{{ url_for('entrusted_book.create') }}">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" aria-hidden="true">
            <path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2Z"></path>
        </svg>
        new book
    </a>
</div>

{% if books %}
<table class="table table--fixed">
    <thead>
    <tr>
        <th style="width: 5%;">id</th>
        <th style="width: 50%;">name</th>
        <th style="width: 25%;">update at</th>
        <th style="width: 20%;">action</th>
    </tr>
    </thead>
    <tbody>
    {% for book in books %}
    <tr class="clickable-row"
        data-href="{{ url_for('entrusted_book.detail', book_id=book.id) }}">
        <td>{{ book.id }}</td>
        <td class="truncate">{{ book.name }}</td>
        <td>{{ book.updated_at.strftime('%Y-%m-%d') if book.updated_at else '' }}</td>
        <td class="actions">
            <!-- 行クリックを優先させないため stopPropagation は JS 側で対応 -->
            <a class="btn" href="{{ url_for('entrusted_book.edit', book_id=book.id) }}" aria-label="edit {{ book.name }}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" aria-hidden="true">
                    <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Z"></path>
                </svg>
            </a>
            <a class="btn" href="{{ url_for('entrusted_book.confirm_delete', book_id=book.id) }}" aria-label="delete {{ book.name }}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" aria-hidden="true">
                    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
                </svg>
            </a>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<div style="width:1000px;margin:1.5rem auto;color:#57606a;">No entrusted books yet.</div>
{% endif %}

<!-- JS -->
<script src="{{ url_for('static', filename='js/table.js') }}" defer></script>
</body>
</html>