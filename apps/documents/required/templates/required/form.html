<!-- apps/documents/required/templates/required/form.html -->
{% extends "_layout/form_base.html" %}

<!-- ヘッダー左アイコン -->
{% set icon = 'icon/24/file-badge.svg' %}

<!-- フォームがヘッダー外の送信ボタンを受け取れるようにIDを決める -->
{% set form_id = "required-form" %}

<!-- タイトル -->
{% block title %}
{{ client.name }}
{% endblock %}

<!-- ヘッダータイトル -->
{% block heading %}
Required
{% endblock %}

<!-- ヘッダーメタ情報 -->
{% block header_meta %}
<span class="form-header__heading">- {{ client.name }} -</span>
{% endblock %}

<!-- ヘッダー右側：アクション -->
{% block header_actions %}
<button type="submit" class="btn primary" form="{{ form_id }}">
    {% if is_edit %}
    <img src="{{ url_for('static', filename='icon/16/check.svg') }}" alt=""> Update
    {% else %}
    <img src="{{ url_for('static', filename='icon/16/new.svg') }}" alt=""> Create
    {% endif %}
</button>
<a class="btn secondary" href="{{ back_url or url_for('client.documents_index', client_id=client.id) }}">
    <img src="{{ url_for('static', filename='icon/16/x.svg') }}" alt=""> Cancel
</a>
{% endblock %}

<!-- 本文 -->
{% block content %}
<form id="{{ form_id }}" method="POST">
    {{ form.hidden_tag() }}
    {{ form.client_id() }}

    <div class="container">
        <div class="form-box">

            <!-- 受託簿名 -->
            <div class="form-group">
                {{ form.entrusted_book_name.label(class="form-label") }}
                {{ form.entrusted_book_name(class="form-input") }}
                {% if form.entrusted_book_name.errors %}
                <ul class="form-errors">
                    {% for e in form.entrusted_book_name.errors %}
                    <li>{{ e }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <!-- 発信日 -->
            <div class="form-group">
                {{ form.sent_date.label(class="form-label") }}
                {{ form.sent_date(class="form-input", type="date") }}
                {% if form.sent_date.errors %}
                <ul class="form-errors">
                    {% for e in form.sent_date.errors %}
                    <li>{{ e }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <!-- 挨拶文（上段） -->
            <div class="form-group">
                {{ form.greeting_paragraph.label(class="form-label") }}
                {{ form.greeting_paragraph(class="form-textarea", rows="6",
                placeholder="拝啓、毎々格別のお引立にあずかり厚くお礼申し上げます。…") }}
                {% if form.greeting_paragraph.errors %}
                <ul class="form-errors">
                    {% for e in form.greeting_paragraph.errors %}
                    <li>{{ e }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <!-- 同封した書類 -->
            <div class="form-group">
                <label class="form-label">同封した書類</label>
                <div class="table-container">
                    <table class="form-table">
                        <colgroup>
                            <col style="width:55%">
                            <col style="width:30%">
                            <col style="width:15%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>書類名</th>
                            <th>注釈</th>
                            <th>枚数</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for sub in form.mailed_documents %}
                        <tr>
                            <td>{{ sub.form.doc_name(class="form-input form-table__input") }}</td>
                            <td>{{ sub.form.note(class="form-input form-table__input") }}</td>
                            <td>{{ sub.form.copies(class="form-input form-table__input") }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 本文（中段） -->
            <div class="form-group">
                {{ form.main_paragraph.label(class="form-label") }}
                {{ form.main_paragraph(class="form-textarea", rows="6") }}
                {% if form.main_paragraph.errors %}
                <ul class="form-errors">
                    {% for e in form.main_paragraph.errors %}
                    <li>{{ e }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>

            <!-- 返送依頼書類 -->
            <div class="form-group">
                <label class="form-label">返信用封筒で返送いただきたい書類</label>
                <div class="table-container">
                    <table class="form-table">
                        <colgroup>
                            <col style="width:55%">
                            <col style="width:30%">
                            <col style="width:15%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>書類名</th>
                            <th>注釈</th>
                            <th>枚数</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for sub in form.requested_return_documents %}
                        <tr>
                            <td>{{ sub.form.doc_name(class="form-input form-table__input") }}</td>
                            <td>{{ sub.form.note(class="form-input form-table__input") }}</td>
                            <td>{{ sub.form.copies(class="form-input form-table__input") }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 結び（下段） -->
            <div class="form-group">
                {{ form.closing_paragraph.label(class="form-label") }}
                {{ form.closing_paragraph(class="form-textarea", rows="6") }}
                {% if form.closing_paragraph.errors %}
                <ul class="form-errors">
                    {% for e in form.closing_paragraph.errors %}
                    <li>{{ e }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
        </div>
    </div>
</form>
{% endblock %}